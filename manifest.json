{
  "manifest_version": 3,
  "name": "IOCLens - Threat Intel Enrichment",
  "version": "1.1.2",
  "description": "Enrich IOCs (IP, domains, URLs, hashes) with threat intelligence from VirusTotal and other. Right-click any IOC to analyze.",
  "author": "IOCLens",

  "browser_specific_settings": {
    "gecko": {
      "id": "ioclens@firefox.extension",
      "strict_min_version": "109.0"
    }
  },

  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  },

  "permissions": [
    "contextMenus",
    "storage",
    "notifications"
  ],

  "host_permissions": [
    "http://ip-api.com/*",
    "https://ip-api.com/*",
    "https://ipapi.co/*",
    "https://www.virustotal.com/*",
    "https://api.abuseipdb.com/*",
    "https://api.shodan.io/*",
    "https://urlhaus-api.abuse.ch/*",
    "https://threatfox-api.abuse.ch/*",
    "https://otx.alienvault.com/*",
    "https://api.greynoise.io/*",
    "https://ioclens-for-chrome.vercel.app/*"
  ],

  "background": {
    "scripts": ["rate-limiter.js", "background.js"]
  },

  "action": {
    "default_popup": "popup/popup.html",
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    },
    "default_title": "IOCLens - Analyze Threat Indicators"
  },

  "options_page": "options/options.html",

  "content_security_policy": {
    "extension_pages": "default-src 'self'; script-src 'self'; object-src 'none'; base-uri 'none'; frame-ancestors 'none'; connect-src 'self' http://ip-api.com https://ip-api.com https://ipapi.co https://www.virustotal.com https://api.abuseipdb.com https://api.shodan.io https://urlhaus-api.abuse.ch https://threatfox-api.abuse.ch https://otx.alienvault.com https://api.greynoise.io https://ioclens-for-chrome.vercel.app"
  }
}
